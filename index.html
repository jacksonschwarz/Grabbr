<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<style>
		/*basic styling*/
		body{
			background-color: black;
			cursor: pointer;
			overflow: hidden;
		}
		/*Defining the scores class and individual positions of score*/
		.scores{
			position:absolute;
			height:12vh;
			width:12vh;
			border-radius: 100%;
			background-color: #00cc00;
			border: 5px groove #1aff1a;
			top:-150px;
			box-shadow: 0 0 50px white;
		}
			
		/*defining the obstacle class and individual positions for obstacles*/
		.obstacles{
			position:absolute;
			height:10vh;
			width: 10vh;
			background-color:red;
			border-radius: 100%;
			border: 5px groove #e62000;
			top: -150px;
			box-shadow: 0 0 25px red;
		}
		#restart-block{
			height:100%;
			width:100%;
			background-color:;
			text-align: center;
			vertical-align: middle;
			font-size: 8vh;
			font-family: Courier, sans-serif;
			color: white;
			text-shadow: 2px 2px black;
			display:;
		}
		#scoreboard{
			color: white;
			text-align: center;
			font-family: Courier, sans-serif;
			font-size: 14vh;
			opacity: 0.5;
			cursor: pointer;
			display:none;
		}
	</style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<body>
			
					<div id="scoreboard">
						0
					</div>
					<div id="score1" class="scores"></div>
					<div id="score2" class="scores"></div>
					<div id="score3" class="scores"></div>
					<div id="score4" class="scores"></div>
					<div id="score5" class="scores"></div>
					
					
					<div id="obstacle1" class="obstacles"></div>
					<div id="obstacle2" class="obstacles"></div>
					<div id="obstacle3" class="obstacles"></div>
					<div id="obstacle4" class="obstacles"></div>
					<div id="obstacle5" class="obstacles"></div>
					<div id="obstacle6" class="obstacles"></div>
					<div id="obstacle7" class="obstacles"></div>
					<div id="obstacle8" class="obstacles"></div>
					<div id="obstacle9" class="obstacles"></div>
					<div id="obstacle10" class="obstacles"></div>
					
					<div id="restart-block">
						Press Enter to start playing. Hover your cursor over the green tokens, and avoid the red obstacles. The larger the browser size, the better the experience.
					</div>

					<audio id="scoreSound">
						<source src="sounds/getPoint.wav">
						<source src="sounds/getPoint.ogg">
						<source src="sounds/getPoint.mp3">
					</audo>
					<audio id="hitSound">
						<source src="sounds/hit.wav">
						<source src="sounds/hit.ogg">
						<source src="sounds/hit.mp3">
					</audio>
			</div>

	</body>
	<script>
		$(document).ready(function(){
			var tracing=false;
			var paused=false;
			
			var scoreCount=0;
			var sucessSound=document.getElementById("scoreSound");
			var hitSound=document.getElementById("hitSound");
			var scores=[0];
			var highScore=0;
			
			var speed=1500;
			
			var scoreHeight= 12;
			var scoreWidth= 12;
			
			
			var calculateMax=function(arr){
				var max=arr[0];
				for(var i=0;i<arr.length;i++){
					if(arr[i] > max)
					{
						max=arr[i];
					}
				}
				return max;
			};

			//For random generation, use the window width and height rather than hard numbers
			var randomScores=function(){
				//places scores
				for(var i=1;i<6;i++)
				{
					var randX=Math.round(Math.random()*innerWidth)-scoreWidth*4;
					var randY=20+Math.round(Math.random()*innerHeight)-scoreHeight*4;
					$("#score"+i).animate({
						left: randX+"px",
						top: randY+"px"
					},350);
				}
				$(".scores").fadeIn(1000);
			};
			var randomObstacles=function(){
				$(".obstacles").fadeIn(1000);
				//places obstacles
				for(var i=1;i<11;i++)
				{
					var randX=20+Math.round(Math.random()*innerWidth)-24;
					var randY=20+Math.round(Math.random()*innerHeight)-24;
					$("#obstacle"+i).animate({
						left: randX+"px",
						top: randY+"px"
					},speed);
				}
			};
			//resets the board. Clears the line, stops tracing, and (soon) will set the cursor position.
			var reset=function(){
				$(".obstacles").hide();
				$(".obstacles").css("top", "-150px");
				$(".obstacles").css("left","-150px");
				$(".scores").hide();
				$(".scores").css("top", "-150px");
				$(".scores").css("left","-150px");
				$(".scores").css("height", "12vh");
				$(".scores").css("width", "12vh");
				scoreHeight=12;
				scoreWidth=12;
				$("#scoreboard").text("0");
				$("#scoreboard").css("font-size", "14vh");
				if(scoreCount == calculateMax(scores))
					highScore=scoreCount;
				scoreCount=0;
				
				speed=1500;
				tracing=false;
				points="";
				$("#path").attr("points", "");
				$("#scoreboard").hide();
				$("#restart-block").show();
				for(var i=1;i<11;i++)
				{
					$("#obstacle"+i).stop(true);
				}
				for(var i=1;i<6;i++)
				{
					$("#score"+i).stop(true);
				}
				
			};
			var newLevel=function(){
				randomScores();
				randomObstacles();
				$("#restart-block").hide();
			};
			$("body").keypress(function(){
				if(event.which == 13)
				{
					if(!paused){
						tracing=true;
						newLevel();
						$("#scoreboard").show();
						$("#scoreboard").text(""+scoreCount);
						$("#scoreboard").css("font-size", "83vh");
					}
				}
				if(event.which==32)
				{
					if(!paused)
					{
						paused=true;
						$(".obstacles").stop(true);
						$(".obstacles").fadeTo(500, 0.25);
						$(".scores").fadeTo(500, 0.25);
						$("#scoreboard").text("Paused. press the Spacebar to resume");
						$("#scoreboard").css("font-size", "10vh");
						tracing=false;
					}
					else{
						$(".obstacles").fadeTo(100, 1);
						$(".scores").fadeTo(100, 1);
						paused=false;
						randomObstacles();
						randomScores();
						tracing=true;
					}
				}
			});
			//Traces the line
			$("body").mousemove(function(){
				var x=event.pageX;
				var y=event.pageY;
				if(tracing){
					//drawLine(x,y);
					//$("#path").attr("points", points);
					randomObstacles();
					$("#restart-block").text("GAME OVER: Press Enter to restart! Your score was: "+scoreCount+". The score to beat was: "+highScore);
				}
				//$("#debug").text("DEBUG: x="+x+", y="+y);
			});
			$(".scores").mouseover(function(){
				if(tracing)
				{
					//don't fade out, if you fade out it counts as multiple scores
					$(this).hide();
					scoreCount++;
					$("#scoreboard").text(""+scoreCount);
					sucessSound.play();
					sucessSound.currentTime=0;
					if(scoreCount % 5==0)
					{
						randomScores();
						if(scoreHeight > 3 || scoreWidth > 3)
						{
							scoreHeight--;
							scoreWidth--;
							$(".scores").animate({
								height: scoreHeight+"vh",
								width: scoreWidth+"vh"
							}, 500);
						}
					}
				}

			});
			$(".obstacles").mouseover(function(){
				if(tracing){
					scores.push(scoreCount);
					hitSound.play();
					reset();
				}
			});
			$(window).resize(function(){
				$("#restart-block").css("font-size", "10vh");
				if(tracing && !paused){
					$("#scoreboard").css("font-size", "83vh");
					$(".obstacles").stop(true);
					$(".scores").stop(true);
					randomObstacles();
					randomScores();
				}
				if(paused)
				{
					$("#scoreboard").css("font-size", "10vh");
				}

			});
		});
	</script>
</html>
